{"ast":null,"code":"var _jsxFileName = \"/Users/pbaid.int/collabEye/client/src/components/project/Editor.js\",\n  _s = $RefreshSig$();\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\nimport Quill from 'quill';\nimport \"quill/dist/quill.snow.css\";\nimport \"quill/dist/quill.bubble.css\";\nimport * as actionEditor from \"../../action/actionEditor.js\";\nimport styles from \"../../styles/components/project/Editor.module.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Editor(_ref) {\n  _s();\n  let {\n    socket\n  } = _ref;\n  const {\n    login: {\n      user\n    },\n    project: {\n      project_id,\n      is_admin\n    },\n    editor: {\n      contents\n    }\n  } = useSelector(state => state);\n  const dispatch = useDispatch();\n  const {\n    setQuillData,\n    saveQuillData\n  } = bindActionCreators(actionEditor, dispatch);\n  const [quill, setQuill] = useState();\n  const wrapperRef = useCallback(wrapper => {\n    if (wrapper == null) return;\n    wrapper.innerHTML = '';\n    const editor = document.createElement('div');\n    wrapper.append(editor);\n    const q = new Quill(editor, {\n      modules: {\n        ...(!is_admin && {\n          toolbar: false\n        })\n      },\n      theme: 'snow'\n    });\n    q.setContents(contents);\n    if (!is_admin) q.disable();else if (is_admin) q.enable();\n    setQuill(q);\n  }, [is_admin]);\n  useEffect(() => {\n    if (socket == null || quill == null || socket.connected === false) return;\n    const socketHandler = data => {\n      quill.updateContents(data.delta);\n    };\n    const syncData = data => {\n      quill.setContents(data.contents);\n    };\n    socket.on(\"receive-changes\", socketHandler);\n    socket.on(\"sync-data\", syncData);\n  }, [socket, quill]);\n  useEffect(() => {\n    if (socket == null || quill == null || socket.connected === false) return;\n    const quillHandler = (delta, oldDelta, source) => {\n      if (source !== \"user\") return;\n      socket.emit(\"send-changes\", {\n        delta,\n        project_id,\n        id: user.id,\n        contents: quill.getContents()\n      });\n      setQuillData(quill.getContents());\n    };\n    quill.on(\"text-change\", quillHandler);\n    return () => {\n      quill.off(\"text-change\", quillHandler);\n    };\n  }, [socket, quill, project_id, user]);\n  if (!socket || socket.connected === false) {\n    return /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"LOADING...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }, this);\n  }\n  const sync = () => {\n    console.log('sync called');\n    if (socket == null || quill == null || socket.connected === false) return;\n    socket.emit(\"current-editor-contents\", {\n      contents: quill.getContents(),\n      project_id\n    });\n  };\n  const save = () => {\n    if (quill == null) return;\n    saveQuillData(quill.getContents());\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.outercont,\n    children: [is_admin ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.controlBar,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.saveBtn,\n        onClick: () => save(),\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 68\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 11\n    }, this) : null, /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"container\",\n      className: styles.editorContainer,\n      ref: wrapperRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 5\n  }, this);\n}\n_s(Editor, \"EhAd17kdf2lQVfW6QEE97kwhHa0=\", false, function () {\n  return [useSelector, useDispatch];\n});\n_c = Editor;\nvar _c;\n$RefreshReg$(_c, \"Editor\");","map":{"version":3,"names":["React","useCallback","useEffect","useState","useDispatch","useSelector","bindActionCreators","Quill","actionEditor","styles","jsxDEV","_jsxDEV","Editor","_ref","_s","socket","login","user","project","project_id","is_admin","editor","contents","state","dispatch","setQuillData","saveQuillData","quill","setQuill","wrapperRef","wrapper","innerHTML","document","createElement","append","q","modules","toolbar","theme","setContents","disable","enable","connected","socketHandler","data","updateContents","delta","syncData","on","quillHandler","oldDelta","source","emit","id","getContents","off","children","fileName","_jsxFileName","lineNumber","columnNumber","sync","console","log","save","className","outercont","controlBar","saveBtn","onClick","editorContainer","ref","_c","$RefreshReg$"],"sources":["/Users/pbaid.int/collabEye/client/src/components/project/Editor.js"],"sourcesContent":["import React, { useCallback, useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\nimport Quill from 'quill'\nimport \"quill/dist/quill.snow.css\"\nimport \"quill/dist/quill.bubble.css\"\nimport * as actionEditor from \"../../action/actionEditor.js\";\nimport styles from \"../../styles/components/project/Editor.module.css\";\n\nexport default function Editor({ socket }) {\n\n  const { login: { user }, project: { project_id, is_admin },\n    editor: { contents } } = useSelector((state) => state);\n\n  const dispatch = useDispatch();\n  const { setQuillData, saveQuillData } = bindActionCreators(actionEditor, dispatch);\n\n  const [quill, setQuill] = useState();\n\n  const wrapperRef = useCallback(wrapper => {\n    if (wrapper == null) return;\n\n    wrapper.innerHTML = '';\n    const editor = document.createElement('div');\n    wrapper.append(editor);\n    const q = new Quill(editor, { modules: { ...(!is_admin && ({ toolbar: false })) }, theme: 'snow' });\n    q.setContents(contents)\n    if (!is_admin) q.disable()\n    else if (is_admin) q.enable()\n    setQuill(q);\n  }, [is_admin])\n\n  useEffect(() => {\n    if (socket == null || quill == null || socket.connected === false) return\n\n    const socketHandler = (data) => {\n      quill.updateContents(data.delta);\n    }\n    const syncData = (data) => {\n      quill.setContents(data.contents);\n    }\n    socket.on(\"receive-changes\", socketHandler)\n    socket.on(\"sync-data\", syncData)\n  }, [socket, quill])\n\n  useEffect(() => {\n    if (socket == null || quill == null || socket.connected === false) return\n\n    const quillHandler = (delta, oldDelta, source) => {\n      if (source !== \"user\") return\n      socket.emit(\"send-changes\", { delta, project_id, id: user.id, contents: quill.getContents() })\n      setQuillData(quill.getContents())\n    }\n    quill.on(\"text-change\", quillHandler)\n\n    return () => {\n      quill.off(\"text-change\", quillHandler)\n    }\n  }, [socket, quill, project_id, user])\n\n  if (!socket || socket.connected === false) {\n    return (<h1>LOADING...</h1>);\n  }\n\n  const sync = () => {\n    console.log('sync called');\n    if (socket == null || quill == null || socket.connected === false) return\n    socket.emit(\"current-editor-contents\", { contents: quill.getContents(), project_id })\n  }\n\n  const save = () => {\n    if (quill == null) return\n    saveQuillData(quill.getContents())\n  }\n\n  return (\n    <div className={styles.outercont}>\n      {\n        is_admin ?\n          <div className={styles.controlBar}>\n            <div className={styles.saveBtn} onClick={() => save()}><p>Save</p></div>\n          </div>\n          : null\n      }\n      <div id=\"container\" className={styles.editorContainer} ref={wrapperRef}>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}